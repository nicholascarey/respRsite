<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Closed-chamber respirometry • respR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Closed-chamber respirometry">
<meta property="og:description" content="respR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">List of Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importing.html">Importing your data</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Intermittent-flow respirometry: Simple example</a>
    </li>
    <li>
      <a href="../articles/intermittent2.html">Intermittent-flow respirometry: Complex example</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Pcrit analysis</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Discussion
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/auto_rate_performance.html">auto_rate: Performance in detecting linear regions</a>
    </li>
    <li>
      <a href="../articles/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
    </li>
    <li>
      <a href="../articles/packages_comp.html">respR: Comparisons with other R packages</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">respR: Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">respR: Reporting reproducible analyses</a>
    </li>
    <li>
      <a href="../articles/usage.html">respR: When to use respR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="closed_files/header-attrs-2.8/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Closed-chamber respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/master/vignettes/closed.Rmd"><code>vignettes/closed.Rmd</code></a></small>
      <div class="hidden name"><code>closed.Rmd</code></div>

    </div>

    
    
<div id="a-typical-respr-workflow-closed-chamber-respirometry" class="section level2">
<h2 class="hasAnchor">
<a href="#a-typical-respr-workflow-closed-chamber-respirometry" class="anchor"></a>A typical respR workflow: Closed-chamber respirometry</h2>
<p>Here we describe a typical workflow for a <strong>closed-chamber</strong> respirometry experiment. The example data used here is <code>urchins.rd</code>, where the first column of the data frame is <em>time</em> data, while the remaining 18 columns are dissolved <em><span class="math inline">\(O_2\)</span></em> data. Columns 18 and 19 contain background respiration recordings. The units are minutes and mg/L of <span class="math inline">\(O_2\)</span>, however all analyses in <code>respR</code> are unitless, and we only consider units when we later come to convert rates.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">urchins.rd</span><span class="op">)</span>
<span class="co">#&gt;    time.min    a    b    c    d    e    f    g    h    i    j    k    l    m</span>
<span class="co">#&gt; 1:      0.0 7.86 7.86 7.64 7.65 7.87 7.74 7.62 7.65 7.96 7.75 7.72 7.71 7.87</span>
<span class="co">#&gt; 2:      0.2 7.87 7.79 7.60 7.71 7.87 7.72 7.61 7.66 7.97 7.72 7.71 7.71 7.89</span>
<span class="co">#&gt; 3:      0.3 7.89 7.70 7.60 7.70 7.90 7.72 7.61 7.63 7.98 7.72 7.69 7.77 7.89</span>
<span class="co">#&gt; 4:      0.5 7.90 7.68 7.60 7.72 7.92 7.74 7.62 7.66 7.97 7.72 7.70 7.77 7.89</span>
<span class="co">#&gt; 5:      0.7 7.87 7.64 7.60 7.67 7.90 7.73 7.59 7.65 7.95 7.71 7.66 7.76 7.86</span>
<span class="co">#&gt; 6:      0.8 7.82 7.69 7.61 7.61 7.88 7.70 7.60 7.65 7.94 7.70 7.63 7.72 7.86</span>
<span class="co">#&gt;       n    o    p   b1   b2</span>
<span class="co">#&gt; 1: 7.61 6.96 7.04 7.90 7.70</span>
<span class="co">#&gt; 2: 7.61 6.96 7.01 7.89 7.70</span>
<span class="co">#&gt; 3: 7.65 6.97 7.05 7.90 7.69</span>
<span class="co">#&gt; 4: 7.67 6.96 7.09 7.89 7.69</span>
<span class="co">#&gt; 5: 7.62 6.95 7.00 7.90 7.68</span>
<span class="co">#&gt; 6: 7.61 6.94 6.99 7.90 7.67</span></code></pre></div>
</div>
<div id="check-for-common-errors---inspect" class="section level2">
<h2 class="hasAnchor">
<a href="#check-for-common-errors---inspect" class="anchor"></a>1: Check for common errors - <code>inspect()</code>
</h2>
<p>We first use <code><a href="../reference/inspect.html">inspect()</a></code> to prepare the data and to check for:</p>
<ul>
<li>Missing or non-numeric (<code>NA</code>/<code>NaN</code>) data</li>
<li>Sequential time data</li>
<li>Duplicate time data</li>
<li>Evenly-spaced time data</li>
</ul>
<p>By default, the function assumes the first column of the data frame is <code>time</code>, while the second column is <code>oxygen</code>. However, the <code>time =</code> and <code>oxygen =</code> arguments can modify that behaviour to select particular columns.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urchin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">15</span><span class="op">)</span></code></pre></div>
<pre><code>#&gt; inspect.ft: Data issues detected. For more information use print().</code></pre>
<p><img src="closed_files/figure-html/unnamed-chunk-4-1.png" width="576"></p>
<pre><code>#&gt; 
#&gt; # print.inspect # -----------------------
#&gt;               time.min    n
#&gt; NA/NAN            pass pass
#&gt; sequential        pass    -
#&gt; duplicated        pass    -
#&gt; evenly-spaced     WARN    -
#&gt; 
#&gt; Uneven Time data locations (first 20 shown) in column: time.min 
#&gt;  [1]  1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20
#&gt; Minimum and Maximum intervals in uneven Time data: 
#&gt; [1] 0.1 0.2
#&gt; -----------------------------------------</code></pre>
<pre><code>#&gt; Warning: Time values are not evenly-spaced (numerically).</code></pre>
<p>From the plot, we can see irregularities in these data near the end of the timeseries (in this case the specimen had interfered with the oxygen sensor). A linear regression of the entire data series would therefore give an erroneous calculation of the true rate. However, the bottom output plot shows that over the initial stages of the experiment, oxygen uptake (as determined by a rolling rate across 10% of the entire data) is consistent at around -0.02, and so in this experiment this section would be most suitable for analysis.</p>
<p>The function also warns us that time data is not <em>numerically</em> evenly-spaced. However, <em>this does not mean the data cannot be processed</em>. Rather than make assumptions that rows represent evenly spaced datapoints, the functions in <code>respR</code> use actual time values for analyses and calculations, and so even irregularly spaced data are analysed correctly. This warning is for information purposes only: it is to make the user aware that if they use row numbers for manual operations such as subsetting, the <em>same width</em> may not represent the <em>same time period</em>. For now, the data frame is saved as an object, <code>urchin</code> which contains the original data columns we selected coerced into a data frame, and various other metadata.</p>
<p><strong>It should be noted that using <code><a href="../reference/inspect.html">inspect()</a></code> is optional</strong> - the main functions in <code>respR</code> will readily accept regular <code>R</code> data structures (e.g. data frames, tibbles, vectors) as long as data are numeric and error-free. Running <code><a href="../reference/inspect.html">inspect()</a></code> is a qualitative, exploratory step that highlights potential issues about the data before analysis. We use this particular example, with an obvious error towards the end, to illustrate the point that you should always visualise and explore your data before analysis. <code>respR</code> has been designed to make this easy.</p>
<p><strong>Note there is an older version of this function called <code><a href="../reference/inspect_data.html">inspect_data()</a></code></strong> - this function has been deprecated, but kept in the package to maintain compatibility with older code. It will not be updated in the future, so users should use <code><a href="../reference/inspect.html">inspect()</a></code>.</p>
</div>
<div id="process-background-respiration---calc_rate-bg" class="section level2">
<h2 class="hasAnchor">
<a href="#process-background-respiration---calc_rate-bg" class="anchor"></a>2: Process background respiration - <code>calc_rate.bg()</code>
</h2>
<p>The presence of microorganisms may be a potential source of experimental bias, and we may want to account for background respiration rates during experiments. Since background rates typically account for a small percentage of experimental rates, these so-called “blank” experiments are routinely conducted alongside, or before and after main experiments, and often the rates are averaged across several datasets to obtain a more accurate estimate of the correction.</p>
<p>The function <code><a href="../reference/calc_rate.bg.html">calc_rate.bg()</a></code> is used to process background rate measurements, which must share the <strong>same units of time and oxygen data as the experiments they will be used to correct</strong>. It can also simultaneously process <em>multiple</em> background rate measurements, with the assumption that an average background rate will be applied. In <code>urchins.rd</code>, background respiration was recorded and saved in columns 18 and 19. We analyse the data using the specialised function <code><a href="../reference/calc_rate.bg.html">calc_rate.bg()</a></code> and save the output as an object.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # plot.calc_rate.bg # -------------------</span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<pre><code><a href="https://rdrr.io/r/base/print.html">#&gt; calc_rate.bg: Plotting all 2 background rates ...
#&gt; -----------------------------------------
print(bg)
#&gt; 
#&gt; # print.calc_rate.bg # ------------------
#&gt; Background rate(s):
#&gt; [1] -0.0007650013 -0.0009018607
#&gt; Mean background rate:
#&gt; [1] -0.000833431
#&gt; -----------------------------------------</a></code></pre>
<p>This <code>bg</code> object contains both individual background rates for each data column entered (<code>$bgrate</code>), and an averaged rate (<code>$mean</code>) which, by default, will be used as the correction when this is applied later in <code>adjust_rate</code>.</p>
</div>
<div id="calculate-oxygen-uptake-rate---calc_rate" class="section level2">
<h2 class="hasAnchor">
<a href="#calculate-oxygen-uptake-rate---calc_rate" class="anchor"></a>3: Calculate oxygen uptake rate - <code>calc_rate()</code>
</h2>
<p>Calling the function <code><a href="../reference/calc_rate.html">calc_rate()</a></code> on the <code><a href="../reference/inspect.html">inspect()</a></code> object, with no additional arguments, will prompt the function to perform a linear regression on the entire data series.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span><span class="op">)</span>  <span class="co"># same as: calc_rate(urchin$df)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # plot.calc_rate # ----------------------</span>
<span class="co">#&gt; calc_rate: Plotting rate from position 1 of 1 ...</span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
<pre><code>#&gt; -----------------------------------------
#&gt; 
#&gt; # print.calc_rate # ---------------------
#&gt; Rank 1 of 1 rates:
#&gt; Rate: -0.01749242 
#&gt; 
#&gt; To see full results use summary().
#&gt; -----------------------------------------</code></pre>
<p>Note how the function recognises the <code><a href="../reference/inspect.html">inspect()</a></code> object, with no other inputs necessary. Alternatively, you can specify a <code>data.frame</code> object containing raw data, in which case the function will automatically consider the first column as time data, and the second column as oxygen data (if not in the first two columns, they should be processed via <code><a href="../reference/inspect.html">inspect()</a></code> or otherwise put into this structure).</p>
<p>In many cases, there is a need to truncate or subset the data before rate is determined. For example, we may want to exclude initial stages of instability, determine rate over an exact period of time, or within a threshold of O<sub>2</sub> concentrations. Equipment interference or other factors may cause irregularities in the data. We can work around such errors by specifying the data regions over which we are interested in determining the rate.</p>
<p>Based on the <code>from</code> and <code>to</code> arguments, a user may use <code><a href="../reference/calc_rate.html">calc_rate()</a></code> to specify data ranges in one of four ways:</p>
<ul>
<li>
<strong>Time</strong> (<code>by = "time"</code>): <em>“What is the rate over a specific 25 minute period?”</em>
</li>
<li>
<strong>Oxygen</strong> (<code>by = "oxygen"</code>): <em>“What is the rate between oxygen saturation points of 95% and 80%?”</em>
</li>
<li>
<strong>Row</strong> (<code>by = "row"</code>): <em>“I’d like to determine rate between rows 11 and 273.”</em>
</li>
<li>
<strong>Proportion</strong> (<code>by = "proportion"</code>): <em>“What is the rate from 4/5ths (0.8) to half (0.5) of total oxygen consumed?”</em>
</li>
</ul>
<p>We do not need to be overly precise; for <code>oxygen</code> and <code>time</code> if input values do not match exactly to a value in the data, the function will identify the closest matching values, rounded down, and use these for subsequent calculations.</p>
<p>Here we’ll select a 25 minute period before the interference occurred:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urch_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span>, from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # plot.calc_rate # ----------------------</span>
<span class="co">#&gt; calc_rate: Plotting rate from position 1 of 1 ...</span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-8-1.png" width="576"></p>
<pre><code>#&gt; -----------------------------------------</code></pre>
<p>The saved object can be explored using generic R commands.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.calc_rate # ---------------------</span>
<span class="co">#&gt; Rank 1 of 1 rates:</span>
<span class="co">#&gt; Rate: -0.02177588 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span>

<span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # summary.calc_rate # -------------------</span>
<span class="co">#&gt; Summary of all rate results:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;    rank intercept_b0     rate_b1   rsq row endrow time endtime  oxy endoxy</span>
<span class="co">#&gt; 1:    1     7.636454 -0.02177588 0.987  25    175    4      29 7.58   6.98</span>
<span class="co">#&gt;    rate.2pt        rate</span>
<span class="co">#&gt; 1:   -0.024 -0.02177588</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
<p>The rate can be seen as the second entry <code>rate_b1</code>, and other summary data and model coefficients are saved in the object. In this case the <code>rsq</code> is 0.99, so this appears to be a very good estimate of this urchin’s respiration rate.</p>
<p>The output also includes a <code>rate_2pt</code>. This is the rate determined by simple two-point calculation of difference in O<sub>2</sub> divided by difference in Time. <strong><em>For almost all analyses, the <code>rate_b1</code> should be used</em></strong>. See <a href="https://januarharianto.github.io/respR/articles/twopoint.html">Two-point analyses</a> for an explanation of this output and when it might be useful</p>
<p>Plotting the output provides a series of diagnostic plots of the data subset that was analysed.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">urch_rate</span><span class="op">)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # plot.calc_rate # ----------------------</span>
<span class="co">#&gt; calc_rate: Plotting rate from position 1 of 1 ...</span></code></pre></div>
<p><img src="closed_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
<pre><code>#&gt; -----------------------------------------</code></pre>
</div>
<div id="adjust-for-background-respiration---adjust_rate" class="section level2">
<h2 class="hasAnchor">
<a href="#adjust-for-background-respiration---adjust_rate" class="anchor"></a>4: Adjust for background respiration - <code>adjust_rate()</code>
</h2>
<p>Since background rate has been calculated in <code><a href="../reference/calc_rate.bg.html">calc_rate.bg()</a></code>, adjustment is straightforward using the function <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code>. The rate input to be adjusted can be an object of class <code>calc_rate</code> or <code>auto_rate</code>, or any numeric value.</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, <span class="va">bg</span><span class="op">)</span>
<span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method. </span>
<span class="co">#&gt; Use print() or summary() on output for more info.</span>
<span class="va">urch_rate_adj</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.adjust_rate # -------------------</span>
<span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjustment was applied using the 'mean' method.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span>
<span class="co">#&gt; Rate          : -0.02177588</span>
<span class="co">#&gt; Adjustment    : -0.000833431</span>
<span class="co">#&gt; Adjusted Rate : -0.02094245 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
<p>A background correction can also be entered manually. Care should be taken to include the correct (typically negative) sign.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, <span class="op">-</span><span class="fl">0.00083</span><span class="op">)</span>
<span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method. </span>
<span class="co">#&gt; Use print() or summary() on output for more info.</span>
<span class="va">urch_rate_adj</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.adjust_rate # -------------------</span>
<span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjustment was applied using the 'mean' method.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span>
<span class="co">#&gt; Rate          : -0.02177588</span>
<span class="co">#&gt; Adjustment    : -0.00083</span>
<span class="co">#&gt; Adjusted Rate : -0.02094588 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
<p>For experiments where there is a quantified background <strong>input</strong> of oxygen, such as in <em>open-tank</em> respirometry, <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code> can be used to correct rates using a <em>positive</em> background value.</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, <span class="fl">0.002</span><span class="op">)</span>
<span class="co">#&gt; adjust_rate: Rate adjustments applied using "mean" method. </span>
<span class="co">#&gt; Use print() or summary() on output for more info.</span>
<span class="va">urch_rate_adj</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.adjust_rate # -------------------</span>
<span class="co">#&gt; NOTE: Consider the sign of the adjustment value when adjusting the rate.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Adjustment was applied using the 'mean' method.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Rank 1 of 1 adjusted rate(s):</span>
<span class="co">#&gt; Rate          : -0.02177588</span>
<span class="co">#&gt; Adjustment    : 0.002</span>
<span class="co">#&gt; Adjusted Rate : -0.02377588 </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
</div>
<div id="convert-the-results---convert_rate" class="section level2">
<h2 class="hasAnchor">
<a href="#convert-the-results---convert_rate" class="anchor"></a>5: Convert the results - <code>convert_rate()</code>
</h2>
<p>Note, that until this point <code>respR</code> has <strong>not required units of time or oxygen to be entered</strong>. Here, we convert calculated, unitless rates to specified output units.</p>
<p>For example, we may want to determine:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Absolute metabolic rate</strong> - Total change in O<sub>2</sub> per unit time within the chamber, that is whole animal or whole group metabolic rate</li>
<li>
<strong>Mass-specific metabolic rate</strong> - Rate of oxygen consumption (or production) per unit time per unit mass of the specimen</li>
</ol>
<p>The function <code><a href="../reference/convert_rate.html">convert_rate()</a></code> can be used to convert rate values to absolute or mass-specific values. This requires the units of the original data (<code>o2.unit</code>, <code>time.unit</code>), the <code>volume</code> of fluid in the chamber (in <strong>L</strong>), and for mass-specific rates the <code>mass</code> of the specimen (in <strong>kg</strong>).</p>
<p><strong>Note</strong>: <code>volume</code> is volume of water in the respirometer, <strong><em>not the volume of the respirometer</em></strong>. That is, it represents the <strong><em>effective volume</em></strong>. A specimen occupies space in the respirometer, and so displaces some proportion of the water, which depending on its size might be significant and cause mis-estimates of respiration rates. Therefore the volume of water entered here should equal the total volume of the respirometer <strong>minus the volume of the specimen</strong>.</p>
<p>There are several approaches to determine the effective volume; calculating the specimen volume geometrically or via water displacement in a separate vessel, or calculated from the mass and density (e.g. for fish it is often assumed they have an equal density as water, that is ~1000 kg/m^3). Water volume could also be determined directly by pouring out the water at the end of the experiment, or by weighing the respirometer after the specimen has been removed. The <a href="https://github.com/nicholascarey/respfun"><code>respfun</code></a> utilities package has several functions to assist with determining the effective volume.</p>
<p>For an example of absolute oxygen uptake rate, we can convert the output of <code><a href="../reference/calc_rate.html">calc_rate()</a></code> to O<sub>2</sub> consumed per hour:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>, 
             o2.unit <span class="op">=</span> <span class="st">"mg/L"</span>, 
             time.unit <span class="op">=</span> <span class="st">"min"</span>, 
             output.unit <span class="op">=</span> <span class="st">"mg/h"</span>, 
             volume <span class="op">=</span> <span class="fl">1.09</span><span class="op">)</span>
<span class="co">#&gt; convert_rate: object of class `adjust_rate` detected. Converting all adjusted rates in '$rate.adjusted'.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.convert_rate # ------------------</span>
<span class="co">#&gt; Rank 1 of 1 rates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.02377588</span>
<span class="co">#&gt; [1] "mg/L" "min" </span>
<span class="co">#&gt; Converted:</span>
<span class="co">#&gt; [1] -1.554943</span>
<span class="co">#&gt; [1] "mgO2/hour"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
<p>We can also convert to a mass-specific rate by adding a <code>mass</code> and specifying a mass-specific <code>output.unit</code>:</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>, 
             o2.unit <span class="op">=</span> <span class="st">"mgl-1"</span>, 
             time.unit <span class="op">=</span> <span class="st">"m"</span>, 
             output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>,
             volume <span class="op">=</span> <span class="fl">1.09</span>, 
             mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span>
<span class="co">#&gt; convert_rate: object of class `adjust_rate` detected. Converting all adjusted rates in '$rate.adjusted'.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # print.convert_rate # ------------------</span>
<span class="co">#&gt; Rank 1 of 1 rates:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Input:</span>
<span class="co">#&gt; [1] -0.02377588</span>
<span class="co">#&gt; [1] "mg/L" "min" </span>
<span class="co">#&gt; Converted:</span>
<span class="co">#&gt; [1] -0.002273308</span>
<span class="co">#&gt; [1] "mgO2/sec/kg"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; To see full results use summary().</span>
<span class="co">#&gt; -----------------------------------------</span></code></pre></div>
<p>Note how a “fuzzy” string matching algorithm automatically recognises variations in base units, allowing natural, intuitive input of units. For example, <code>"ml/s"</code>, <code>"mL/sec"</code>, <code>"milliliter/s"</code>, and <code>"millilitre/second"</code> are all equally identified as <code>mL/s</code>. Unit delimiters can be any combination of a space, dot (<code>.</code>), forward-slash (<code><a href="https://rdrr.io/r/base/Arithmetic.html">/</a></code>), or the “per” unit (<code>-1</code>). Thus, <code>"ml/kg"</code>, <code>"mL / kg"</code>, <code>"mL /kilogram"</code>, <code>"ml kg-1"</code> or <code>"ml.kg-1"</code> are equally recognised as <code>mL/kg</code>. For a reminder on what units are available to use, call <code><a href="../reference/unit_args.html">unit_args()</a></code>. Some units require temperature, salinity and atmospheric pressure to perform the conversion:</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/unit_args.html">unit_args</a></span><span class="op">(</span><span class="op">)</span>
<span class="co">#&gt; Note: A string-matching algorithm is used to identify units. </span>
<span class="co">#&gt; Example 1: These are recognised as the same: 'mg/L', 'mg/l', 'mg L-1', 'mg per litre', 'mg.L-1'</span>
<span class="co">#&gt; Example 2: These are recognised as the same: 'hour', 'hr', 'h'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Input Units # --------------------------------------</span>
<span class="co">#&gt; Oxygen concentration units should use SI units (`L` or `kg`) for the denominator.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Oxygen Concentration or Pressure Units - Do not require t, S and P</span>
<span class="co">#&gt; [1] "mg/L"   "ug/L"   "mmol/L" "umol/L"</span>
<span class="co">#&gt; Oxygen Concentration or Pressure Units - Require t, S and P</span>
<span class="co">#&gt;  [1] "mL/L"    "mg/kg"   "ug/kg"   "mmol/kg" "umol/kg" "mL/kg"   "%Air"   </span>
<span class="co">#&gt;  [8] "%O2"     "Torr"    "hPa"     "kPa"     "mmHg"    "inHg"   </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Volume units for use in flow rates in calc_rate.ft and convert_rate.ft</span>
<span class="co">#&gt; (e.g. as in 'ml/min', 'L/s', etc.)</span>
<span class="co">#&gt; [1] "uL" "mL" "L" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Time units (for 'time.unit' or as part of 'flowrate.unit')</span>
<span class="co">#&gt; [1] "sec"  "min"  "hour" "day" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Mass units</span>
<span class="co">#&gt; [1] "ug" "mg" "g"  "kg"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Area units</span>
<span class="co">#&gt; [1] "mm2" "cm2" "m2"  "km2"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; # Output Units in 'convert_rate' &amp; 'convert_rate.ft' #</span>
<span class="co">#&gt; Must be in correct order, with no special characters other than the separator:</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Absolute rates:        O2/Time       e.g. 'mg/sec',     'umol/min',     'mL/h'</span>
<span class="co">#&gt; Mass-specific rates:   O2/Time/Mass  e.g. 'mg/sec/ug',  'umol/min/g',   'mL/h/kg'</span>
<span class="co">#&gt; Area-specific rates:   O2/Time/Area  e.g. 'mg/sec/mm2', 'umol/min/cm2', 'mL/h/m2'</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Output Oxygen amount units</span>
<span class="co">#&gt; [1] "ug"   "mg"   "umol" "mmol" "mol"  "mL"  </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Output Time units</span>
<span class="co">#&gt; [1] "sec"  "min"  "hour" "day" </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Output Mass units for mass-specific rates</span>
<span class="co">#&gt; [1] "ug" "mg" "g"  "kg"</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Output Area units for surface area-specific rates</span>
<span class="co">#&gt; [1] "mm2" "cm2" "m2"  "km2"</span></code></pre></div>
</div>
<div id="summary" class="section level2">
<h2 class="hasAnchor">
<a href="#summary" class="anchor"></a>Summary</h2>
<p>This is an example of a straightforward analysis of a closed-chamber respirometry experiment. This entire analysis can be documented and shared in only a few lines of code, making it easily reproducible if the original data file is included:</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># import and inspect</span>
<span class="va">urchin</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">15</span><span class="op">)</span>

<span class="co"># Background</span>
<span class="va">bg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span>

<span class="co"># Specimen rate</span>
<span class="va">urch_rate</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span><span class="va">urchin</span>, from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span>

<span class="co"># Adjust rate</span>
<span class="va">urch_rate_adj</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span><span class="va">urch_rate</span>, <span class="va">bg</span><span class="op">)</span>

<span class="co"># Convert to final rate units</span>
<span class="va">urchin_MO2</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span><span class="va">urch_rate_adj</span>,
                           o2.unit <span class="op">=</span> <span class="st">"mgl-1"</span>, 
                           time.unit <span class="op">=</span> <span class="st">"m"</span>, 
                           output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>, 
                           volume <span class="op">=</span> <span class="fl">1.09</span>, 
                           mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span></code></pre></div>
<p>Using <a href="https://www.tidyverse.org"><code>tidyverse</code></a> practices (i.e. <a href="https://dplyr.tidyverse.org"><code>dplyr</code></a> pipes), can reduce this even further:</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">urchins.rd</span> <span class="op">%&gt;%</span>                                           <span class="co"># With the data object,</span>
  <span class="fu"><a href="../reference/inspect.html">inspect</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">15</span><span class="op">)</span> <span class="op">%&gt;%</span>                                     <span class="co"># inspect, then</span>
  <span class="fu"><a href="../reference/calc_rate.html">calc_rate</a></span><span class="op">(</span>from <span class="op">=</span> <span class="fl">4</span>, to <span class="op">=</span> <span class="fl">29</span>, by <span class="op">=</span> <span class="st">"time"</span><span class="op">)</span> <span class="op">%&gt;%</span>          <span class="co"># calculate rate, then</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/adjust_rate.html">adjust_rate</a></span><span class="op">(</span>
    <span class="fu"><a href="../reference/calc_rate.bg.html">calc_rate.bg</a></span><span class="op">(</span><span class="va">urchins.rd</span>, time <span class="op">=</span> <span class="fl">1</span>, 
                 oxygen <span class="op">=</span> <span class="fl">18</span><span class="op">:</span><span class="fl">19</span><span class="op">)</span><span class="op">)</span> <span class="op">%&gt;%</span>                    <span class="co"># adjust bg rate, then</span>
  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="../reference/convert_rate.html">convert_rate</a></span><span class="op">(</span>o2.unit <span class="op">=</span> <span class="st">"mgl-1"</span>, time.unit <span class="op">=</span> <span class="st">"m"</span>,     
    output.unit <span class="op">=</span> <span class="st">"mg/s/kg"</span>, volume <span class="op">=</span> <span class="fl">1.09</span>, mass <span class="op">=</span> <span class="fl">0.19</span><span class="op">)</span> <span class="co"># convert units.</span></code></pre></div>
<!-- Other vignettes go into more detail about different experiment types and other analyses.  -->
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
