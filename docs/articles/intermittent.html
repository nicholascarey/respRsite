<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Intermittent-flow respirometry: Simple example â€¢ respR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Intermittent-flow respirometry: Simple example">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">List of Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importing.html">Importing your data</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Intermittent-flow respirometry: Simple example</a>
    </li>
    <li>
      <a href="../articles/intermittent2.html">Intermittent-flow respirometry: Complex example</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Pcrit analysis</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Discussion
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/performance.html">auto_rate: Performance in detecting linear regions</a>
    </li>
    <li>
      <a href="../articles/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
    </li>
    <li>
      <a href="../articles/packages_comp.html">respR: Comparisons with other R packages</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">respR: Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">respR: Reporting reproducible analyses</a>
    </li>
    <li>
      <a href="../articles/usage.html">respR: When to use respR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="intermittent_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Intermittent-flow respirometry: Simple example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/master/vignettes/intermittent.Rmd"><code>vignettes/intermittent.Rmd</code></a></small>
      <div class="hidden name"><code>intermittent.Rmd</code></div>

    </div>

    
    
<div id="intermittent-flow-respirometry" class="section level2">
<h2 class="hasAnchor">
<a href="#intermittent-flow-respirometry" class="anchor"></a>Intermittent-flow respirometry</h2>
<p>Intermittent-flow respirometry involves obtaining multiple replicates in an experiment by periodically flushing the respirometer with fresh treatment water or air after a set period of time or O<sub>2</sub> decrease. Typically, the oxygen sensing system is left recording during flushes so the system returning to normoxia can be seen in the data. If the dataset is not split into the separate replicates, this results in an dataset with oscillating levels of oxygen. This vignette shows a simple example of how an intermittent-flow respirometry experiment can be analysed in <code>respR</code>. Another <a href="https://januarharianto.github.io/respR/articles/intermittent2.html">example is provided</a> to show how a longer, more complex intermittent-flow experiment with differing background rates can be analysed.</p>
</div>
<div id="a-relatively-simple-example" class="section level2">
<h2 class="hasAnchor">
<a href="#a-relatively-simple-example" class="anchor"></a>A relatively simple example</h2>
<p>The example data, <code>intermittent.rd</code>, contains intermittent-flow measurements of oxygen consumption in the sea urchin <em>Heliocidaris erythrogramma</em>. Detailed information about the data, including its source and methods, can be obtained with the command <code><a href="../reference/intermittent.rd.html">?intermittent.rd</a></code>.</p>
<p>We use <code><a href="../reference/inspect.html">inspect()</a></code> to scan for errors in the data frame, preview the data and save it to an object to pass to the next stage.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a>urchin_int &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(intermittent.rd)</span></code></pre></div>
<pre><code>#&gt; No issues detected while inspecting data frame.</code></pre>
<p><img src="intermittent_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<pre><code>#&gt; 
#&gt; # inspect # -----------------------------
#&gt;               Time   O2
#&gt; NA/NAN        pass pass
#&gt; sequential    pass    -
#&gt; duplicated    pass    -
#&gt; evenly-spaced pass    -</code></pre>
<p>We can see from the top plot that this dataset has three replicates. The flush periods obviously skew the bottom plot, which shows rate of change (positive or negative) in O<sub>2</sub> concentration over a rolling window of 10% of the data. However specimen uptake rates (flat regions) appear to be relatively consistent within each experimental replicate.</p>
</div>
<div id="analysis-with-calc_rate" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-with-calc_rate" class="anchor"></a>Analysis with calc_rate()</h2>
<p>In the near future <code>respR</code> will support intermittent-flow data directly with a dedicated function to easily identify and subset replicates, but at present intermittent data can be analysed quite easily via the main <code><a href="../reference/calc_rate.html">calc_rate()</a></code> function with a little organisation.</p>
<div id="subsetting-by-row-and-time" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-by-row-and-time" class="anchor"></a>Subsetting by row and time</h3>
<p>The <code>calc_rate</code> function supports input of multiple subset regions by <code>row</code> or <code>time</code>. The <code>from</code> and <code>to</code> operators can be vectors with paired values:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>urchin_int_rates &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">200</span>, <span class="dv">2300</span>, <span class="dv">4100</span>), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">1800</span>, </span>
<span id="cb4-2"><a href="#cb4-2"></a>    <span class="dv">3200</span>, <span class="dv">4600</span>), <span class="dt">by =</span> <span class="st">"time"</span>)</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-5-1.png" width="672"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(urchin_int_rates)</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt; </span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt; # calc_rate # -------------------</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt; Rate(s):</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt; [1] -0.0005734109 -0.0006097325 -0.0006539752</span></span></code></pre></div>
<p>Calling <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> will show the coefficients and locations of each subset:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(urchin_int_rates)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">#&gt; Summary:</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">#&gt;    intercept_b0       rate_b1   rsq  row endrow time endtime  oxy endoxy</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">#&gt; 1:     7.127202 -0.0005734109 0.995  201   1801  200    1800 7.05   6.11</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">#&gt; 2:     8.528274 -0.0006097325 0.990 2301   3201 2300    3200 7.12   6.58</span></span>
<span id="cb6-6"><a href="#cb6-6"></a><span class="co">#&gt; 3:     9.731918 -0.0006539752 0.967 4101   4601 4100    4600 7.08   6.73</span></span>
<span id="cb6-7"><a href="#cb6-7"></a><span class="co">#&gt;    rowlength timelength rate_twopoint</span></span>
<span id="cb6-8"><a href="#cb6-8"></a><span class="co">#&gt; 1:      1600       1600    -0.0005875</span></span>
<span id="cb6-9"><a href="#cb6-9"></a><span class="co">#&gt; 2:       900        900    -0.0006000</span></span>
<span id="cb6-10"><a href="#cb6-10"></a><span class="co">#&gt; 3:       500        500    -0.0007000</span></span></code></pre></div>
<p>We can also use <code><a href="https://rdrr.io/r/graphics/plot.html">plot()</a></code> to view the diagnostic plots of any individual replicate. The argument <code>rep</code> determines which data subset to plot:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="https://rdrr.io/r/graphics/plot.html">plot</a></span>(urchin_int_rates, <span class="dt">rep =</span> <span class="dv">2</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">#&gt; </span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; # plot # ------------------------</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">#&gt; Plotting...this may take a while for large datasets.</span></span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-7-1.png" width="700"></p>
<pre><code>#&gt; Done.</code></pre>
<p>We can even query multiple regions of each replicate (which can overlap, although this would obscure the output plot somewhat):</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">200</span>, <span class="dv">900</span>, <span class="dv">2300</span>, <span class="dv">2900</span>, <span class="dv">4000</span>, <span class="dv">4400</span>), <span class="dt">to =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">700</span>, <span class="dv">1700</span>, </span>
<span id="cb9-2"><a href="#cb9-2"></a>    <span class="dv">2700</span>, <span class="dv">3300</span>, <span class="dv">4300</span>, <span class="dv">4700</span>), <span class="dt">by =</span> <span class="st">"time"</span>)</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-8-1.png" width="672"></p>
<pre><code>#&gt; 
#&gt; # calc_rate # -------------------
#&gt; Rate(s):
#&gt; [1] -0.0006790314 -0.0005463056 -0.0005853780 -0.0005705494 -0.0006845746
#&gt; [6] -0.0006334074</code></pre>
</div>
<div id="extracting-rate-results" class="section level3">
<h3 class="hasAnchor">
<a href="#extracting-rate-results" class="anchor"></a>Extracting rate results</h3>
<p>Rates can be easily extracted for further analysis or selection. For instance, we may be interested in the lowest rate, the one most representative of basal metabolic rates. Of course because rates are negative, the minimum <em>value</em> in negative terms would actually represent the highest rate, so we should extract the maximum (least negative) value, or transform the rates first:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a>urchin_int_rates<span class="op">$</span>rate</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; [1] -0.0005734109 -0.0006097325 -0.0006539752</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="kw"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span>(<span class="op">-</span><span class="dv">1</span> <span class="op">*</span><span class="st"> </span>urchin_int_rates<span class="op">$</span>rate)</span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; [1] 0.0005734109</span></span></code></pre></div>
<p>Or, we may be more interested in the mean rate:</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="kw"><a href="https://rdrr.io/r/base/mean.html">mean</a></span>(urchin_int_rates<span class="op">$</span>rate)</span>
<span id="cb12-2"><a href="#cb12-2"></a><span class="co">#&gt; [1] -0.0006123729</span></span></code></pre></div>
</div>
<div id="subsetting-by-oxygen" class="section level3">
<h3 class="hasAnchor">
<a href="#subsetting-by-oxygen" class="anchor"></a>Subsetting by oxygen</h3>
<p>If we are interested in looking at rates over particular oxygen ranges within each replicate, <code><a href="../reference/calc_rate.html">calc_rate()</a></code> will find the first match to the range entered:</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int, <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-11-1.png" width="672"></p>
<pre><code>#&gt; 
#&gt; # calc_rate # -------------------
#&gt; Rate(s):
#&gt; [1] -0.0006191943</code></pre>
<p>To examine the same range in each replicate, we can follow a number of approaches. We can call the data range containing another replicate directly from the original dataset, or data frame saved within the <code><a href="../reference/inspect.html">inspect()</a></code> object:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(intermittent.rd[<span class="dv">2100</span><span class="op">:</span><span class="dv">3500</span>, ], <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="co">#&gt; </span></span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">#&gt; # calc_rate # -------------------</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; Rate(s):</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; [1] -0.000615731</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(urchin_int<span class="op">$</span>dataframe[<span class="dv">2100</span><span class="op">:</span><span class="dv">3500</span>, ], <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; # calc_rate # -------------------</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; Rate(s):</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; [1] -0.000615731</span></span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-13-1.png" width="672"></p>
<p>Or we can subset them manually into new dataframes, and process them separately through the entire workflow. Here we use the dedicated <code><a href="../reference/subset_data.html">subset_data()</a></code> function in <code>respR</code>, which allows easy subsetting by time, oxygen or row number. For best results, these should exclude the flush periods.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># Create separate replicate data frames</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>u_rep1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_data.html">subset_data</a></span>(intermittent.rd, <span class="dt">from =</span> <span class="dv">1</span>, <span class="dt">to =</span> <span class="dv">1900</span>, <span class="dt">by =</span> <span class="st">"time"</span>)</span>
<span id="cb16-3"><a href="#cb16-3"></a>u_rep2 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_data.html">subset_data</a></span>(intermittent.rd, <span class="dt">from =</span> <span class="dv">2100</span>, <span class="dt">to =</span> <span class="dv">3500</span>, <span class="dt">by =</span> <span class="st">"time"</span>)</span>
<span id="cb16-4"><a href="#cb16-4"></a>u_rep3 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_data.html">subset_data</a></span>(intermittent.rd, <span class="dt">from =</span> <span class="dv">3700</span>, <span class="dt">to =</span> <span class="dv">4831</span>, <span class="dt">by =</span> <span class="st">"time"</span>)</span>
<span id="cb16-5"><a href="#cb16-5"></a></span>
<span id="cb16-6"><a href="#cb16-6"></a><span class="co"># Process one in `inspect()` (output not shown)</span></span>
<span id="cb16-7"><a href="#cb16-7"></a>u_rep3_c &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(u_rep3)</span></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="../reference/calc_rate.html">calc_rate</a></span>(u_rep3_c, <span class="dt">from =</span> <span class="dv">7</span>, <span class="dt">to =</span> <span class="fl">6.6</span>, <span class="dt">by =</span> <span class="st">"o2"</span>)</span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-15-1.png" width="672"></p>
<pre><code>#&gt; 
#&gt; # calc_rate # -------------------
#&gt; Rate(s):
#&gt; [1] -0.0006188192</code></pre>
</div>
</div>
<div id="analysis-with-auto_rate" class="section level2">
<h2 class="hasAnchor">
<a href="#analysis-with-auto_rate" class="anchor"></a>Analysis with auto_rate()</h2>
<p>To more rigourously identify minimum, maximum or most linear rates we can use the <code><a href="../reference/auto_rate.html">auto_rate()</a></code> function, however because this does not support (as yet) subsetting internally, each replicate must be subset and analysed separately. See other vignettes for more detail on using <code><a href="../reference/auto_rate.html">auto_rate()</a></code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="co">## subset first replicate</span></span>
<span id="cb19-2"><a href="#cb19-2"></a>u_rep1 &lt;-<span class="st"> </span><span class="kw"><a href="../reference/subset_data.html">subset_data</a></span>(intermittent.rd, <span class="dt">from =</span> <span class="dv">0</span>, <span class="dt">to =</span> <span class="dv">1900</span>, <span class="dt">by =</span> <span class="st">"time"</span>)</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">## analyse in auto_rate</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(u_rep1)  <span class="co">#default = most linear rate</span></span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-17-1.png" width="700"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="kw"><a href="../reference/auto_rate.html">auto_rate</a></span>(u_rep1, <span class="dt">method =</span> <span class="st">"min"</span>)  <span class="co"># minimum rate</span></span></code></pre></div>
<p><img src="intermittent_files/figure-html/unnamed-chunk-17-2.png" width="700"></p>
</div>
<div id="background-adjustments" class="section level2">
<h2 class="hasAnchor">
<a href="#background-adjustments" class="anchor"></a>Background adjustments</h2>
<p>For background adjustments, the <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code> function can be used on <code>calc_rate</code> objects containing multiple rate values:</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a>urchin_int_rates_adj &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adjust_rate.html">adjust_rate</a></span>(urchin_int_rates, <span class="dt">by =</span> <span class="fl">-5e-05</span>)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">#&gt; </span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">#&gt; Rate adjustments applied. Use print() command for more info.</span></span>
<span id="cb22-4"><a href="#cb22-4"></a>urchin_int_rates_adj<span class="op">$</span>input.rate</span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">#&gt; [1] -0.0005734109 -0.0006097325 -0.0006539752</span></span>
<span id="cb22-6"><a href="#cb22-6"></a>urchin_int_rates_adj<span class="op">$</span>corrected</span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">#&gt; [1] -0.0005234109 -0.0005597325 -0.0006039752</span></span></code></pre></div>
<p>We can see each individual rate has been adjusted, and the new rates can be extracted from the resulting object using <code>$corrected</code>.</p>
</div>
<div id="converting-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-rates" class="anchor"></a>Converting rates</h2>
<p>Once the rates have been determined, they can be converted to volume-corrected or mass-specific rates using <code><a href="../reference/convert_rate.html">convert_rate()</a></code>.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>u_rates_final &lt;-<span class="st"> </span><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(urchin_int_rates_adj, </span>
<span id="cb23-2"><a href="#cb23-2"></a>                              <span class="dt">o2.unit =</span> <span class="st">"mg/L"</span>, </span>
<span id="cb23-3"><a href="#cb23-3"></a>                              <span class="dt">time.unit =</span> <span class="st">"s"</span>, </span>
<span id="cb23-4"><a href="#cb23-4"></a>                              <span class="dt">output.unit =</span> <span class="st">"mg/h/g"</span>, </span>
<span id="cb23-5"><a href="#cb23-5"></a>                              <span class="dt">volume =</span> <span class="fl">2.379</span>, </span>
<span id="cb23-6"><a href="#cb23-6"></a>                              <span class="dt">mass =</span> <span class="fl">0.006955</span>)</span></code></pre></div>
<p>Only the first rate converted rate is shown in the output, but all rates determined are converted and can be extracted.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>u_rates_final<span class="op">$</span>input</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="co">#&gt; [1] -0.0005234109 -0.0005597325 -0.0006039752</span></span>
<span id="cb24-3"><a href="#cb24-3"></a>u_rates_final<span class="op">$</span>output</span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">#&gt; [1] -0.6445291 -0.6892556 -0.7437362</span></span></code></pre></div>
</div>
<div id="more-complex-intermittent-flow-experiments" class="section level2">
<h2 class="hasAnchor">
<a href="#more-complex-intermittent-flow-experiments" class="anchor"></a>More complex intermittent-flow experiments</h2>
<p>A more complex intermittent-flow analysis is provided <a href="https://januarharianto.github.io/respR/articles/intermittent2.html">here</a>.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#intermittent-flow-respirometry">Intermittent-flow respirometry</a></li>
      <li><a href="#a-relatively-simple-example">A relatively simple example</a></li>
      <li><a href="#analysis-with-calc_rate">Analysis with calc_rate()</a></li>
      <li><a href="#analysis-with-auto_rate">Analysis with auto_rate()</a></li>
      <li><a href="#background-adjustments">Background adjustments</a></li>
      <li><a href="#converting-rates">Converting rates</a></li>
      <li><a href="#more-complex-intermittent-flow-experiments">More complex intermittent-flow experiments</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
