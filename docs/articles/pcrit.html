<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Pcrit • respR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Pcrit">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">List of Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importing.html">Importing your data</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Intermittent-flow respirometry: Simple example</a>
    </li>
    <li>
      <a href="../articles/intermittent2.html">Intermittent-flow respirometry: Complex example</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Pcrit analysis</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Discussion
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/auto_rate_performance.html">auto_rate: Performance in detecting linear regions</a>
    </li>
    <li>
      <a href="../articles/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
    </li>
    <li>
      <a href="../articles/packages_comp.html">respR: Comparisons with other R packages</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">respR: Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">respR: Reporting reproducible analyses</a>
    </li>
    <li>
      <a href="../articles/usage.html">respR: When to use respR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="pcrit_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Pcrit</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/master/vignettes/pcrit.Rmd"><code>vignettes/pcrit.Rmd</code></a></small>
      <div class="hidden name"><code>pcrit.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level3">
<h3 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h3>
<p>In some species (<em>oxyconformers</em>) routine oxygen uptake rate is directly proportional to oxygen concentration. So, for example, at 50% O<sub>2</sub>, the uptake rate will be half that at 100% O<sub>2</sub>. Many species however (<em>oxyregulators</em>) are able to regulate uptake and maintain routine rates as oxygen decreases. Note however, there is a continuum of responses between these extremes, and intermediate cases (Mueller and Seymour, 2011).</p>
<p>The concentration below which routine uptake becomes unsustainable is termed the critical partial pressure of O<sub>2</sub>, or <span class="math inline">\(P_{crit}\)</span>. Historically, this was expressed in units of partical pressure of oxygen, but more recently it is also commonly expressed in units of concentration.</p>
<p><span class="math inline">\(P_{crit}\)</span> is typically determined in long term, closed respirometry experiments in which the specimen is allowed to deplete the oxygen in the chamber to hypoxia, and the resulting oxygen trace is used to identify the breakpoint in the relationship of uptake rate to O<sub>2</sub> concentration.</p>
</div>
<div id="example-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h3>
<p>The example data, <code>squid.rd</code>, contains data from a long term experiment in the market squid, <em>Doryteuthis opalescens</em>. Detailed information about the data, including its source and methods, can be obtained with the command <code><a href="../reference/squid.rd.html">?squid.rd</a></code>. This dataset is extremely large; over 34000 rows representing 9.5h of data. However the functions in <code>respR</code> are highly optimised and efficient, so only users on older machines should experience any delay waiting for code to complete.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(squid.rd)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">#&gt;   Time       o2</span></span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="co">#&gt; 1    0 7.726446</span></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; 2    1 7.726446</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt; 3    2 7.726446</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt; 4    3 7.726446</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; 5    4 7.726446</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; 6    5 7.726446</span></span></code></pre></div>
</div>
<div id="inspecting-data" class="section level3">
<h3 class="hasAnchor">
<a href="#inspecting-data" class="anchor"></a>Inspecting data</h3>
<p>We can examine the dataset using the <code>inspect_data</code> function.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>market.squid &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect.html">inspect</a></span>(squid.rd)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt; No issues detected while inspecting data frame.</span></span></code></pre></div>
<p><img src="pcrit_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>We can see from the bottom plot, a rolling rate across 10% of the total data, that the uptake rate is relatively consistent to around row 12,000, after which it declines steadily. We cannot tell from this plot which O<sub>2</sub> concentration this represents. For now, we can see the dataset is free of errors or issues, so we can pass the saved <code>market.squid</code> object to the dedicated <code><a href="../reference/pcrit.html">pcrit()</a></code> function.</p>
</div>
<div id="p_crit-function" class="section level3">
<h3 class="hasAnchor">
<a href="#p_crit-function" class="anchor"></a><span class="math inline">\(P_{crit}\)</span> function</h3>
<p>The <code><a href="../reference/pcrit.html">pcrit()</a></code> function provides three methods to report the breakpoint in the rate ~ O<sub>2</sub> relationship.</p>
<p>The first two are from the “broken-stick” regression (BSR) approach, adapted from Yeager &amp; Ultsch (1989) in which two segments of the data are iteratively fitted and the intersection with the smallest sum of the residual sum of squares between the two linear models is the estimated critical point. Two slightly different ways of reporting this breakpoint are detailed by Yeager &amp; Ultsch (1989); the <em>intercept</em> and <em>midpoint</em>. These are usually close in value.</p>
<p>The third method in the <code><a href="../reference/pcrit.html">pcrit()</a></code> function is a wrapper for the “segmented regression”" approach, available as part of the <code>segmented</code> R package (Muggeo 2008), which estimates the critical point by iteratively fitting two intersecting models and selecting the point that minimises the “gap” between the fitted lines.</p>
<p>Note that at present, <code>pcrit</code> does not accept <code>inpect</code> or <code>inspect_data</code> objects, but we can easily call the data frame within these directly:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>market.squid.pcrit &lt;-<span class="st"> </span><span class="kw"><a href="../reference/pcrit.html">pcrit</a></span>(market.squid<span class="op">$</span>df)</span></code></pre></div>
<pre><code>#&gt; Performing broken-stick analysis...
#&gt; Performing segmented (breakpoint) analysis...
#&gt; Convergence attained in 1 iterations.</code></pre>
<p><img src="pcrit_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(market.squid.pcrit)</span></code></pre></div>
<pre><code>#&gt; --Broken stick (Yeager &amp; Ultsch 1989)--
#&gt; Sum RSS     1.2689e-07
#&gt; Intercept   2.60922
#&gt; Midpoint    2.60805
#&gt; 
#&gt; --Segmented (Muggeo 2003)--
#&gt; Std. Err.   0.00995977
#&gt; Breakpoint  2.60922</code></pre>
<p>The output figure shows all three metrics plotted against the original data and on rate ~ O<sub>2</sub> plots. The <code><a href="https://rdrr.io/r/base/print.html">print()</a></code> summary shows that, in this case, all three methods give very similar values for the <span class="math inline">\(P_{crit}\)</span>: 2.61, 2.61 and 2.62 mg L<sup>-1</sup>. We should note that for some data, depending on various characteristics, such as noise, abruptness of the break, etc., the different methods may provide different results. See the later section for some general discussion of the different methods.</p>
<p><strong>Note</strong>, that the <code>pcrit</code> function has a <code>width</code> input, which controls the width of the rolling regressions used to calculate the rolling rate values. This necessarily affects estimations of the <span class="math inline">\(P_{crit}\)</span>. The default value of 0.1 of the total length of data in our testing seems to provide good results, but in some data changing this may give better results.</p>
<p>Also important to note is that the segmented (Muggeo) method sometimes gives a different result when the exact same code is run. See the documentation for the <a href="https://cran.r-project.org/web/packages/segmented/"><code>segmented</code></a> package and publications by Muggeo for the details of why this is, but briefly, it comes from a randomisation of the starting point for the initial analysis. The differences introduced by this are usually minor.</p>
<p>The <code><a href="../reference/pcrit.html">pcrit()</a></code> function also includes a default <code>parallel = TRUE</code> argument. This instructs the function to use parallel processing to speed up the analysis, if your system supports it. In the case of errors or problems using the function, changing this to <code>FALSE</code> is a good first step in diagnosing the problem.</p>
</div>
<div id="use-of-existing-rate-data" class="section level3">
<h3 class="hasAnchor">
<a href="#use-of-existing-rate-data" class="anchor"></a>Use of existing <em>rate</em> data</h3>
<p>The example above used raw Time ~ O<sub>2</sub> data, and so the function calculated a rolling rate internally. However, the function can accept already calculated rate ~ O<sub>2</sub> data using the argument <code>has.rate = TRUE</code>, and the function will determine <span class="math inline">\(P_{crit}\)</span> using these data directly. These data can be either whole specimen rates (<span class="math inline">\(\dot{V}O_2\)</span>), or mass-specific rates (<span class="math inline">\(\dot{M}O_2\)</span>); both give identical results.</p>
</div>
<div id="adjustments" class="section level3">
<h3 class="hasAnchor">
<a href="#adjustments" class="anchor"></a>Adjustments</h3>
<p>Note, the <code><a href="../reference/pcrit.html">pcrit()</a></code> function does not support adjusting rates for background effects. Background O<sub>2</sub> uptake should not affect <span class="math inline">\(P_{crit}\)</span> as it is typically minimal and assumed to be uniform over the course of an experiment. We are considering how to support background corrections in this function. For now, users should be aware that rates extracted from objects of class <code>pcrit</code> will not have been background-corrected.</p>
</div>
<div id="extracting-results" class="section level3">
<h3 class="hasAnchor">
<a href="#extracting-results" class="anchor"></a>Extracting results</h3>
<p>Results of <code><a href="../reference/pcrit.html">pcrit()</a></code> analyses can be extracted from the results object via the following:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co"># Broken-stick regression (Yeager &amp; Ultsch, 1989)</span></span>
<span id="cb7-2"><a href="#cb7-2"></a>market.squid.pcrit<span class="op">$</span>result.intercept</span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">#&gt; [1] 2.609219</span></span>
<span id="cb7-4"><a href="#cb7-4"></a>market.squid.pcrit<span class="op">$</span>result.midpoint</span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">#&gt; [1] 2.60805</span></span>
<span id="cb7-6"><a href="#cb7-6"></a></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co"># Segmented regression (Muggeo 2003).</span></span>
<span id="cb7-8"><a href="#cb7-8"></a>market.squid.pcrit<span class="op">$</span>result.segmented</span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">#&gt; [1] 2.609219</span></span></code></pre></div>
<p>We can also export the results into a .csv file using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="https://rdrr.io/r/base/summary.html">summary</a></span>(market.squid.pcrit)</span>
<span id="cb8-2"><a href="#cb8-2"></a><span class="co">#&gt; Top Result for all Methods:</span></span>
<span id="cb8-3"><a href="#cb8-3"></a><span class="co">#&gt;    splitpoint       sumRSS pcrit.intercept pcrit.mpoint    l1_coef.b0</span></span>
<span id="cb8-4"><a href="#cb8-4"></a><span class="co">#&gt; 1:    2.60432 1.268899e-07        2.609219      2.60805 -0.0002118622</span></span>
<span id="cb8-5"><a href="#cb8-5"></a><span class="co">#&gt;      l1_coef.b1   l2_coef.b0   l2_coef.b1 pcrit.segmented</span></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co">#&gt; 1: 0.0001844198 0.0002375708 1.217176e-05        2.609219</span></span>
<span id="cb8-7"><a href="#cb8-7"></a></span>
<span id="cb8-8"><a href="#cb8-8"></a><span class="co"># Uncomment to run</span></span>
<span id="cb8-9"><a href="#cb8-9"></a></span>
<span id="cb8-10"><a href="#cb8-10"></a><span class="co"># write.csv(summary(market.squid.pcrit), 'results.csv')</span></span></code></pre></div>
</div>
<div id="comparisons-to-other-implementations" class="section level2">
<h2 class="hasAnchor">
<a href="#comparisons-to-other-implementations" class="anchor"></a>Comparisons to other implementations</h2>
<p>The <code>segmented</code> method included in the <code><a href="../reference/pcrit.html">pcrit()</a></code> function in <code>respR</code> is simply a wrapper for the <a href="https://cran.r-project.org/web/packages/segmented/"><code>segmented</code></a> package by Muggeo (2008). Thus, comparing <code>respR</code> results to those from this package would be moot. See the documentation of that package, plus publications by Muggeo for discussion of this method.</p>
<p>The other methods we implement at present are the two ‘broken-stick regression’ (BSR) metrics of Yeager and Ultsch (1989). To our knowledge, <code>rMR</code> is the only other R package that has this functionality. This is example code taken from the documentation for <code>rMR</code> calculating <span class="math inline">\(P_{crit}\)</span> for the included <code>fishMR</code> dataset, which we compare with the results from <code>respR</code> using the same data.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## rMR PCrit Analysis</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co"># load data</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(fishMR)</span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co"># format time</span></span>
<span id="cb9-6"><a href="#cb9-6"></a>fishMR<span class="op">$</span>std.time &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/as.POSIXlt.html">as.POSIXct</a></span>(fishMR<span class="op">$</span>Date.time, <span class="dt">format =</span> <span class="st">"%d/%m/%Y %I:%M:%S %p"</span>)</span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co"># calc pcrit</span></span>
<span id="cb9-8"><a href="#cb9-8"></a>pcrit_rMR &lt;-<span class="st"> </span><span class="kw">get.pcrit</span>(<span class="dt">data =</span> fishMR, <span class="dt">DO.var.name =</span> <span class="st">"DO.mgL"</span>, <span class="dt">Pcrit.below =</span> <span class="dv">2</span>, <span class="dt">time.var =</span> <span class="st">"std.time"</span>, </span>
<span id="cb9-9"><a href="#cb9-9"></a>    <span class="dt">time.interval =</span> <span class="dv">120</span>, <span class="dt">start.time =</span> <span class="st">"2015-07-03 04:45:00"</span>, <span class="dt">stop.time =</span> <span class="st">"2015-07-03 08:05:00"</span>)</span></code></pre></div>
<p><img src="pcrit_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a></span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co"># print results</span></span>
<span id="cb10-3"><a href="#cb10-3"></a>pcrit_rMR<span class="op">$</span>SummaryCrit<span class="op">$</span>Pcrit.lm</span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt; [1] 0.8048335</span></span>
<span id="cb10-5"><a href="#cb10-5"></a>pcrit_rMR<span class="op">$</span>SummaryCrit<span class="op">$</span>Pcrit.midpoint</span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">#&gt; [1] 0.8716833</span></span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## respR PCrit Analysis</span></span>
<span id="cb11-2"><a href="#cb11-2"></a></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co"># extract time and o2 column, and format to numeric time starting at zero</span></span>
<span id="cb11-4"><a href="#cb11-4"></a>fishMR_respR &lt;-<span class="st"> </span>fishMR[<span class="dv">46000</span><span class="op">:</span><span class="dv">58000</span>, <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">2</span>, <span class="dv">6</span>)]</span>
<span id="cb11-5"><a href="#cb11-5"></a>fishMR_respR[, <span class="dv">1</span>] &lt;-<span class="st"> </span>fishMR_respR[, <span class="dv">1</span>] <span class="op">-</span><span class="st"> </span>fishMR_respR[<span class="dv">1</span>, <span class="dv">1</span>]</span>
<span id="cb11-6"><a href="#cb11-6"></a></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co"># perform respR pcrit analysis</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="kw"><a href="../reference/pcrit.html">pcrit</a></span>(fishMR_respR)</span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">#&gt; Performing broken-stick analysis...</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">#&gt; Performing segmented (breakpoint) analysis...</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">#&gt; Convergence attained in 1 iterations.</span></span></code></pre></div>
<p><img src="pcrit_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<pre><code>#&gt; --Broken stick (Yeager &amp; Ultsch 1989)--
#&gt; Sum RSS     1.04572e-06
#&gt; Intercept   0.835538
#&gt; Midpoint    0.837137
#&gt; 
#&gt; --Segmented (Muggeo 2003)--
#&gt; Std. Err.   0.00634307
#&gt; Breakpoint  0.835538</code></pre>
<p>Note that the <code>rMR</code> results (0.80 and 0.87) are different to those from <code>respR</code> (0.84 and 0.84). This is likely due to an improved implementation of the BMR method in <code>respR</code>. The <code>respR</code> analysis uses rolling (i.e. overlapping) regressions, while the <code>rMR</code> implementation uses interval (i.e. non-overlapping) regressions to calculate rates. This means that in the <code>rMR</code> implementation the width of regressions has a large effect on the ultimate result, which the user has to balance. A wide width means better estimates of rate, but fewer in total. A narrow width means less accurate estimates of rate, but a greater number of estimates upon which to perform the breakpoint analysis. This is much less of an issue in <code>respR</code>; because the regressions overlap, the width has much less of an effect upon the total number of estimates of rate.</p>
<p>However, note that the user still needs to carefully consider the width (the default is 0.1 of the total data length); too narrow and it will increase noise amongst the rate estimates, too wide and it will cause breakpoints to be less pronounced.See <a href="https://januarharianto.github.io/respR/articles/auto_rate.html#adjusting-the-width-of-rolling-regressions">adjusting the width of rolling regressions</a> for an example of how width affects the shape of rolling rate plots.</p>
<p>The rolling vs. interval regression methods in the <code>rMR</code> and <code>respR</code> implementations of BSR also make it difficult to directly compare their outputs using the same inputs. However, the fact that the two BSR <code>respR</code> results (0.84 and 0.84) are identical to each other, and also extremely close to the result from the <code>segmented</code> method (0.85) (which uses a completely different technique to identify breakpoints), suggests that the <code>respR</code> implementation is reliable.</p>
</div>
<div id="discussion-of-p_crit-estimation-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#discussion-of-p_crit-estimation-methods" class="anchor"></a>Discussion of <span class="math inline">\(P_{crit}\)</span> estimation methods</h2>
<p>Currently <code>respR</code> has implemented three methods of calculating a breakpoint in the relationship of O<sub>2</sub> uptake rate to O<sub>2</sub> concentration. It is in our plans to support several more (e.g. Duggleby, 1984; Lighton and Turner, 2004, Marshall et al., 2013), and additionally, metrics which describe the degree of oxyregulation of a specimen in intermediate cases (e.g. Tang, 1933; Mueller &amp; Seymour, 2011).</p>
<p>Discussion of ‘breakpoint’ identification in time-series data is a whole branch of mathematics, which we do not have the expertise to discuss. The user should however be aware of the controversy around using the BSR method to estimate <span class="math inline">\(P_{crit}\)</span>.</p>
<p>Marshall et al. (2013) discussed the limitations of the BSR methods, and found them to be inaccurate and prone to error. This publication is a convincing critique of the BSR methods, and posits that use of them was understandable in the past when computing power and analytical processing was limited, but that this should no longer be a limitation, and better methods are available. A very valid point from this analysis is that BSR approaches provide no estimates of error, making it difficult to judge just how reliable they are.</p>
<p>Whether or not this is the definitive critique of this method is still an open question; scientific methods persist through consensus, and BSR is still in use by many prominent physiologists in the years since this publication (Chu &amp; Gale, 2017; Regan &amp; Richards,2017; Stoffels et al. 2017). It remains to be seen if the non-linear regression (NLR) methods proposed by Marshall et al. will supplant other methods of estimating <span class="math inline">\(P_{crit}\)</span>. It is a rigorous method, which indeed appears to be more reliable, and we plan to support this method in a future update to <code>respR</code>.</p>
<p>As far as we are aware, there is no controversy around using the <code>segmented</code> method of Muggeo (2008), and in our testing it usually gives similar results to the BSR approach with data that is high-resolution and not particularly noisy. Until we implement other options such as the NLR methods of Marshall et al., we would encourage users to use the <code>segmented</code> method when in doubt, and carefully consider use of the BSR approach. As we saw in the examples above, all three methods often give similar results, in which case it is likely the BSR results would be appropriate to report. However, there may be cases where the results from these different methods differ.</p>
<p>Different methods are discussed amongst the literature cited below. It is important to note that <span class="math inline">\(P_{crit}\)</span> is most frequently used as a <em>comparative</em> metric. Since analytical options chosen by the investigator (such as regression width) inherently affect the result, it is arguably more important that these are kept the same amongst analyses that will be the basis of comparisons, rather than consideration of the ultimate values of <span class="math inline">\(P_{crit}\)</span> <em>per se</em>. So, it is important that investigators fully report the parameters under which these analyses have been conducted. This allows editors and reviewers to reproduce and assess analyses, and subsequent investigators to know if comparisons to their own results are appropriate. <code>respR</code> has been designed to make the process of reporting these analyses straightforward (see <a href="https://januarharianto.github.io/respR/articles/reproducibility.html">open science and reproducibility using respR</a>).</p>
</div>
<div id="references" class="section level2">
<h2 class="hasAnchor">
<a href="#references" class="anchor"></a>References</h2>
<p>Chu, J. W. F., &amp; Gale, K. S. P. (2017). Ecophysiological limits to aerobic metabolism in hypoxia determine epibenthic distributions and energy sequestration in the northeast Pacific ocean. Limnology and Oceanog- raphy, 62(1), 59-74. <a href="https://doi.org/10.1002/lno.10370" class="uri">https://doi.org/10.1002/lno.10370</a></p>
<p>Duggleby, R.G., 1984. Regression analysis of nonlinear Arrhenius plots: An empirical model and a computer program. Computers in Biology and Medicine 14, 447–455. <a href="https://doi.org/10.1016/0010-4825(84)90045-3" class="uri">https://doi.org/10.1016/0010-4825(84)90045-3</a></p>
<p>Lighton, J.R.B., Turner, R.J., 2004. Thermolimit respirometry: an objective assessment of critical thermal maxima in two sympatric desert harvester ants, Pogonomyrmex rugosus and P. californicus. Journal of Experimental Biology 207, 1903–1913. <a href="https://doi.org/10.1242/jeb.00970" class="uri">https://doi.org/10.1242/jeb.00970</a></p>
<p>Marshall, D.J., Bode, M., White, C.R., 2013. Estimating physiological tolerances - a comparison of traditional approaches to nonlinear regression techniques. Journal of Experimental Biology 216, 2176–2182. <a href="https://doi.org/10.1242/jeb.085712" class="uri">https://doi.org/10.1242/jeb.085712</a></p>
<p>Mueller, C.A., Seymour, R.S., 2011. The Regulation Index: A New Method for Assessing the Relationship between Oxygen Consumption and Environmental Oxygen. Physiological and Biochemical Zoology 84, 522–532. <a href="https://doi.org/10.1086/661953" class="uri">https://doi.org/10.1086/661953</a></p>
<p>Muggeo, V.M.R., 2008. Modeling temperature effects on mortality: multiple segmented relationships with common break points. Biostatistics 9, 613–620. <a href="https://doi.org/10.1093/biostatistics/kxm057" class="uri">https://doi.org/10.1093/biostatistics/kxm057</a></p>
<p>Regan, M. D., &amp; Richards, J. G. (2017). Rates of hypoxia induction alter mechanisms of O2 uptake and the critical O2 tension of goldfish. The Journal of Experimental Biology, 220(14), 2536-2544. <a href="https://doi.org/" class="uri">https://doi.org/</a> 10.1242/jeb.154948</p>
<p>Stoffels, R. J., Weatherman, K. E., &amp; Allen-Ankins, S. (2017). Heat and hypoxia give a global invader, Gambusia holbrooki, the edge over a threatened endemic fish on Australian floodplains. Biological Inva- sions, 19(8), 2477-2489. <a href="https://doi.org/10.1007/s10530-017-1457-6" class="uri">https://doi.org/10.1007/s10530-017-1457-6</a></p>
<p>Tang, P.-S., 1933. On the rate of oxygen consumption by tissues and lower organisms as a function of oxygen tension. The Quarterly Review of Biology 8, 260–274. <a href="https://doi.org/10.1086/394439" class="uri">https://doi.org/10.1086/394439</a></p>
<p>Yeager, D.P., Ultsch, G.R., 1989. Physiological regulation and conformation: A BASIC program for the determination of critical points. Physiological Zoology 62, 888–907. <a href="https://doi.org/10.1086/physzool.62.4.30157935" class="uri">https://doi.org/10.1086/physzool.62.4.30157935</a></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#comparisons-to-other-implementations">Comparisons to other implementations</a></li>
      <li><a href="#discussion-of-p_crit-estimation-methods">Discussion of <span class="math inline">\(P_{crit}\)</span> estimation methods</a></li>
      <li><a href="#references">References</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
