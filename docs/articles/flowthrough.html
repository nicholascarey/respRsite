<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Flowthrough respirometry • respR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Flowthrough respirometry">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">respR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home"></span>
     
  </a>
</li>
<li>
  <a href="../articles/respR.html">Getting Started</a>
</li>
<li>
  <a href="../reference/index.html">List of Functions</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Documentation
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/importing.html">Importing your data</a>
    </li>
    <li>
      <a href="../articles/auto_rate.html">auto_rate: Automatic detection of linear rates</a>
    </li>
    <li>
      <a href="../articles/closed.html">Closed-chamber respirometry</a>
    </li>
    <li>
      <a href="../articles/intermittent.html">Intermittent-flow respirometry: Simple example</a>
    </li>
    <li>
      <a href="../articles/intermittent2.html">Intermittent-flow respirometry: Complex example</a>
    </li>
    <li>
      <a href="../articles/flowthrough.html">Flowthrough respirometry</a>
    </li>
    <li>
      <a href="../articles/pcrit.html">Pcrit analysis</a>
    </li>
    <li>
      <a href="../articles/twopoint.html">Two-point analysis</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Discussion
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/performance.html">auto_rate: Performance in detecting linear regions</a>
    </li>
    <li>
      <a href="../articles/auto_rate_comp.html">auto_rate: Comparisons with LoLinR</a>
    </li>
    <li>
      <a href="../articles/packages_comp.html">respR: Comparisons with other R packages</a>
    </li>
    <li>
      <a href="../articles/tidyverse.html">respR: Integration with the tidyverse</a>
    </li>
    <li>
      <a href="../articles/reproducibility.html">respR: Reporting reproducible analyses</a>
    </li>
    <li>
      <a href="../articles/usage.html">respR: When to use respR</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/januarharianto/respr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="flowthrough_files/header-attrs-2.1/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Flowthrough respirometry</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/januarharianto/respr/blob/master/vignettes/flowthrough.Rmd"><code>vignettes/flowthrough.Rmd</code></a></small>
      <div class="hidden name"><code>flowthrough.Rmd</code></div>

    </div>

    
    
<p>Flowthrough respirometry differs from other methods in that oxygen depletion is measured from a known continuous flow of water through a respirometer, rather than a known volume, typically after the system has achieved equilibrium. In this method, two oxygen concentrations are needed; ‘upstream’ and ‘downstream’ of the experimental chamber, or inflow and outflow concentrations. The inflow concentration is typically a known fixed value and often not continuously monitored, such as fully air-saturated water, or water from a header tank of controlled oxygen concentration. The difference between inflow and outflow concentrations, the O<sub>2</sub> delta, and the flow rate allow calculation of the uptake by the specimen.</p>
<div id="example-data" class="section level3">
<h3 class="hasAnchor">
<a href="#example-data" class="anchor"></a>Example data</h3>
<p>The example data, <code>flowthrough.rd</code>, contains measurements of oxygen consumption in a species of chiton, (<em>Mopalia lignosa</em>, Carey, <em>unpublished</em>). Detailed information about the data, including its source and methods, can be obtained with the command <code><a href="../reference/flowthrough.rd.html">?flowthrough.rd</a></code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(respR)</span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/data.html">data</a></span>(<span class="st">"flowthrough.rd"</span>)</span>
<span id="cb1-3"><a href="#cb1-3"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(flowthrough.rd)</span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">#&gt; # A tibble: 6 x 4</span></span>
<span id="cb1-5"><a href="#cb1-5"></a><span class="co">#&gt;    time o2.out o2.in o2.delta</span></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co">#&gt;   &lt;int&gt;  &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;</span></span>
<span id="cb1-7"><a href="#cb1-7"></a><span class="co">#&gt; 1     0   8.17  8.88    0.710</span></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">#&gt; 2     1   8.17  8.88    0.714</span></span>
<span id="cb1-9"><a href="#cb1-9"></a><span class="co">#&gt; 3     2   8.17  8.90    0.731</span></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co">#&gt; 4     3   8.17  8.88    0.710</span></span>
<span id="cb1-11"><a href="#cb1-11"></a><span class="co">#&gt; 5     4   8.17  8.89    0.712</span></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">#&gt; 6     5   8.17  8.89    0.724</span></span></code></pre></div>
<p>We can see this dataset contains time values, both outflow and inflow O<sub>2</sub> concentrations, and an O<sub>2</sub> delta, which is simply the difference between inflow and outflow. The O<sub>2</sub> delta column is not required; we include it here to show an exploratory step in the next section. While any flowthrough data can be analysed in the <code>calc_rate.ft</code> function, exploring flowthrough data in <code><a href="../reference/inspect_data.html">inspect_data()</a></code> requires a 3 column data frame of time, outflow O<sub>2</sub>, and inflow O<sub>2</sub>. Therefore the user should include all three, even if inflow O<sub>2</sub> is a column of a single fixed value. In this example it varies, but not significantly from a mean value of 8.88.</p>
</div>
<div id="inspecting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#inspecting-data" class="anchor"></a>Inspecting data</h2>
<p>Continuous flowthrough data can be inspected for common errors using the <code><a href="../reference/inspect_data.html">inspect_data()</a></code> function. Note, a newer version of this function is available (<code><a href="../reference/inspect.html">inspect()</a></code>), but at present does not accept flowthrough data. For now, use <code><a href="../reference/inspect_data.html">inspect_data()</a></code> and we will update this vignette when this update is pushed out.</p>
<p>Because flowthrough data will be slightly different we need to use different input operators in <code><a href="../reference/inspect_data.html">inspect_data()</a></code>. By default, <code><a href="../reference/inspect_data.html">inspect_data()</a></code> assumes Time data in column 1 and O<sub>2</sub> data in column 2. For flowthrough data we typically want to look at the outflow O₂ data, which is in column 2 here, so we do not have to change these defaults:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(flowthrough.rd)</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">#&gt; Warning in inspect_data(flowthrough.rd): inspect_data has been deprecated. </span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">#&gt; It will not be updated and will be removed in a future version of respR. </span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">#&gt; Please use the `inspect` function instead.</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">#&gt; o2.delta :  num [1:935] 0.71 0.714 0.731 0.71 0.712 ...</span></span>
<span id="cb2-6"><a href="#cb2-6"></a><span class="co">#&gt; o2.in :  num [1:935] 8.88 8.88 8.9 8.88 8.89 ...</span></span>
<span id="cb2-7"><a href="#cb2-7"></a><span class="co">#&gt; o2.out :  num [1:935] 8.17 8.17 8.17 8.17 8.17 ...</span></span>
<span id="cb2-8"><a href="#cb2-8"></a><span class="co">#&gt; time :  int [1:935] 0 1 2 3 4 5 6 7 8 9 ...</span></span>
<span id="cb2-9"><a href="#cb2-9"></a><span class="co">#&gt; ---</span></span>
<span id="cb2-10"><a href="#cb2-10"></a><span class="co">#&gt;                     Score</span></span>
<span id="cb2-11"><a href="#cb2-11"></a><span class="co">#&gt; No NA/NaN in time   PASS </span></span>
<span id="cb2-12"><a href="#cb2-12"></a><span class="co">#&gt; No NA/NaN in Oxygen PASS </span></span>
<span id="cb2-13"><a href="#cb2-13"></a><span class="co">#&gt; Sequential Time     PASS </span></span>
<span id="cb2-14"><a href="#cb2-14"></a><span class="co">#&gt; Non-duplicated Time PASS </span></span>
<span id="cb2-15"><a href="#cb2-15"></a><span class="co">#&gt; Evenly-spaced Time  PASS</span></span>
<span id="cb2-16"><a href="#cb2-16"></a><span class="co">#&gt; New dataframe generated.</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-3-1.png" width="700"></p>
<p>Unlike in closed respirometry, in a flowthrough experiment oxygen should generally not decline over time, as long as equilibrium has been achieved, and so regions where rates are consistent are more easily identified. Here, using the top plot, we can see the outflow O<sub>2</sub> concentration is most consistent in the early stages of the experiment. Since we know in this experiment inflow O<sub>2</sub> is more-or-less unvarying, this means the specimen’s rate is also most consistent here. In closed respirometry data, the bottom plot shows how the rate of the specimen varies over the dataset, but here it shows the rate of change in outflow O<sub>2</sub> concentration. Therefore, values close to zero indicate regions of highly consistent rates by the <em>specimen</em>. Here, we can see this illustrated well between rows 200 and 400.</p>
<p>If, for experimental reasons, the inflow O<sub>2</sub> concentration is variable, examining consistency in outflow O<sub>2</sub> would not necessarily equate to consistent rates by the specimen. Instead, we can examine O<sub>2</sub> delta data, by using other <code><a href="../reference/inspect_data.html">inspect_data()</a></code> operators to specify the column we are interested in. Here delta O<sub>2</sub> is in column 4:</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(flowthrough.rd, <span class="dt">time =</span> <span class="dv">1</span>, <span class="dt">oxygen =</span> <span class="dv">4</span>)</span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
<p>Here, we can see that after taking into account variable inflow O<sub>2</sub>, the uptake rates of the specimen are most consistent between rows 200 and 300. Note however, this is an exploratory step: these O<sub>2</sub> delta data should not be saved via <code><a href="../reference/adjust_rate.html">adjust_rate()</a></code>. Instead the original inflow and outflow O<sub>2</sub> data should be saved for passing to the next stage, through specifying the columns:</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>chiton.ft &lt;-<span class="st"> </span><span class="kw"><a href="../reference/inspect_data.html">inspect_data</a></span>(flowthrough.rd, <span class="dt">time =</span> <span class="dv">1</span>, <span class="dt">outflow.o2 =</span> <span class="dv">2</span>, <span class="dt">inflow.o2 =</span> <span class="dv">3</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">#&gt; Warning in inspect_data(flowthrough.rd, time = 1, outflow.o2 = 2, inflow.o2 = 3): inspect_data has been deprecated. </span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">#&gt; It will not be updated and will be removed in a future version of respR. </span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">#&gt; Please use the `inspect` function instead.</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">#&gt; New dataframe generated.</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>chiton.ft<span class="op">$</span>df</span>
<span id="cb5-2"><a href="#cb5-2"></a><span class="co">#&gt;      time   inflow  outflow</span></span>
<span id="cb5-3"><a href="#cb5-3"></a><span class="co">#&gt;   1:    0 8.879693 8.169730</span></span>
<span id="cb5-4"><a href="#cb5-4"></a><span class="co">#&gt;   2:    1 8.884703 8.170744</span></span>
<span id="cb5-5"><a href="#cb5-5"></a><span class="co">#&gt;   3:    2 8.900421 8.168974</span></span>
<span id="cb5-6"><a href="#cb5-6"></a><span class="co">#&gt;   4:    3 8.880303 8.170722</span></span>
<span id="cb5-7"><a href="#cb5-7"></a><span class="co">#&gt;   5:    4 8.885802 8.173901</span></span>
<span id="cb5-8"><a href="#cb5-8"></a><span class="co">#&gt;  ---                       </span></span>
<span id="cb5-9"><a href="#cb5-9"></a><span class="co">#&gt; 931:  930 8.873489 8.162386</span></span>
<span id="cb5-10"><a href="#cb5-10"></a><span class="co">#&gt; 932:  931 8.894049 8.164663</span></span>
<span id="cb5-11"><a href="#cb5-11"></a><span class="co">#&gt; 933:  932 8.874755 8.167868</span></span>
<span id="cb5-12"><a href="#cb5-12"></a><span class="co">#&gt; 934:  933 8.887132 8.167505</span></span>
<span id="cb5-13"><a href="#cb5-13"></a><span class="co">#&gt; 935:  934 8.864456 8.165069</span></span></code></pre></div>
<p>We can see only the specifed columns have been included, and the O<sub>2</sub> delta column removed.</p>
<div id="flowthrough-rate-function---calc_rate-ft" class="section level3">
<h3 class="hasAnchor">
<a href="#flowthrough-rate-function---calc_rate-ft" class="anchor"></a>Flowthrough rate function - <code>calc_rate.ft()</code>
</h3>
<p>Rates can be detemined from flowthrough data using the <code><a href="../reference/calc_rate.ft.html">calc_rate.ft()</a></code> function. This function accepts several forms of data input;</p>
<ol style="list-style-type: decimal">
<li>
<p>Single values of inflow and outflow concentrations:</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(<span class="dt">inflow.o2 =</span> <span class="fl">8.88</span>, <span class="dt">outflow.o2 =</span> <span class="fl">8.17</span>, <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span></code></pre></div>
</li>
<li>
<p>Combinations of single or vector values. Vector inputs must be of equal length:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(<span class="dt">inflow.o2 =</span> <span class="fl">8.88</span>, <span class="dt">outflow.o2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8.17</span>, <span class="fl">8.16</span>, <span class="fl">8.15</span>), <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(<span class="dt">inflow.o2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">8.88</span>, <span class="fl">8.87</span>, <span class="fl">8.89</span>), <span class="dt">outflow.o2 =</span> <span class="kw"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="dv">8</span>, <span class="dv">17</span>, <span class="fl">8.16</span>, <span class="fl">8.15</span>), </span>
<span id="cb7-4"><a href="#cb7-4"></a>    <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span>
<span id="cb7-5"><a href="#cb7-5"></a></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(<span class="dt">inflow.o2 =</span> <span class="fl">8.88</span>, <span class="dt">outflow.o2 =</span> flowthrough.rd<span class="op">$</span>o2.out, <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span>
<span id="cb7-7"><a href="#cb7-7"></a></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(<span class="dt">inflow.o2 =</span> flowthrough.rd<span class="op">$</span>o2.in, <span class="dt">outflow.o2 =</span> flowthrough.rd<span class="op">$</span>o2.out, </span>
<span id="cb7-9"><a href="#cb7-9"></a>    <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span></code></pre></div>
</li>
<li>
<p>A data frame containing columns of paired outflow and inflow O<sub>2</sub> values, with column identifiers:</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(flowthrough.rd, <span class="dt">time =</span> <span class="dv">1</span>, <span class="dt">outflow.o2 =</span> <span class="dv">2</span>, <span class="dt">inflow.o2 =</span> <span class="dv">3</span>, <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span></code></pre></div>
</li>
<li>
<p>An object of class <code>inspect_data</code> containing flowthrough data:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(chiton.ft, <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span></code></pre></div>
</li>
</ol>
<p>The <code>flowrate</code> operator is required by the function, and it is assumed it will be an unvarying parameter within each separate experiment. Recordings at different flow rates should be analysed separately. Units for flow rate will be specified when rates are converted later (see below), but they should be in units of volume (in L) per unit time (s,m,h). For example, in this dataset the flow rate is 0.00234 in L m<sup>-1</sup>.</p>
<p>We will calculate rates from the entire dataset using the object we saved earlier from <code><a href="../reference/inspect_data.html">inspect_data()</a></code>:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>chiton.ft.rate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(chiton.ft, <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="co">#&gt; </span><span class="al">NOTE</span><span class="co">: `inspect_data` has been deprecated. Please use `inspect` instead.</span></span>
<span id="cb10-3"><a href="#cb10-3"></a><span class="co">#&gt; object of class `inspect_data` detected. </span></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">#&gt;             Any `inflow.o2` or `outflow.o2` inputs entered here ignored.</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-11-1.png" width="700"></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(chiton.ft.rate)</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">#&gt; Rate (first 6):</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">#&gt; [1] -0.001661315 -0.001670664 -0.001711586 -0.001660421 -0.001665849</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">#&gt; [6] -0.001693805</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">#&gt; </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">#&gt; Mean:</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">#&gt; [1] -0.001651558</span></span></code></pre></div>
<p>The output object includes all calculated rates over the dataset and a mean rate.</p>
</div>
</div>
<div id="subsetting-data" class="section level2">
<h2 class="hasAnchor">
<a href="#subsetting-data" class="anchor"></a>Subsetting data</h2>
<p>The <code><a href="../reference/calc_rate.ft.html">calc_rate.ft()</a></code> function currently does not support subsetting. The dedicated <code><a href="../reference/subset_data.html">subset_data()</a></code> function can be used to prepare data or we can use straightforward R subsetting syntax as follows. We saw earlier how rates between rows 200 and 300 appeared to be most consistent, so we will calculate rates from this data region using the dataframe within the object we saved earlier.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>chiton.ft.rate.sub &lt;-<span class="st"> </span><span class="kw"><a href="../reference/calc_rate.ft.html">calc_rate.ft</a></span>(chiton.ft<span class="op">$</span>df[<span class="dv">200</span><span class="op">:</span><span class="dv">300</span>, ], <span class="dt">outflow.o2 =</span> <span class="dv">3</span>, <span class="dt">inflow.o2 =</span> <span class="dv">2</span>, </span>
<span id="cb12-2"><a href="#cb12-2"></a>    <span class="dt">flowrate =</span> <span class="fl">0.00234</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a><span class="co">#&gt; 'data.frame' object detected. Values in 'inflow.o2' and 'outflow.o2' are used as column </span></span>
<span id="cb12-4"><a href="#cb12-4"></a><span class="co">#&gt;             indices to to extract data from the data frame.</span></span></code></pre></div>
<p><img src="flowthrough_files/figure-html/unnamed-chunk-12-1.png" width="700"></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a><span class="kw"><a href="https://rdrr.io/r/base/print.html">print</a></span>(chiton.ft.rate.sub)</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">#&gt; Rate (first 6):</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">#&gt; [1] -0.001665366 -0.001660479 -0.001705134 -0.001692309 -0.001663122</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">#&gt; [6] -0.001619248</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">#&gt; </span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">#&gt; Mean:</span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">#&gt; [1] -0.001651307</span></span></code></pre></div>
<p>Because the function interprets this as a regular data frame, not <code><a href="../reference/inspect_data.html">inspect_data()</a></code> object, we needed to specify the columns. Again, the output objects includes all calculated rates within the subset and a mean rate. Note the plot row index on the X-axis shows a row index of the subset, not the original row numbers.</p>
</div>
<div id="adjusting-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#adjusting-rates" class="anchor"></a>Adjusting rates</h2>
<p>Similar to the other respirometry methods, a background rate value (typically negative) can be used to adjust flowthrough rates.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>new_adjusted_rate &lt;-<span class="st"> </span><span class="kw"><a href="../reference/adjust_rate.html">adjust_rate</a></span>(chiton.ft.rate.sub<span class="op">$</span>mean, <span class="dt">by =</span> <span class="fl">-5e-04</span>)</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">#&gt; </span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">#&gt; Rate adjustments applied. Use print() command for more info.</span></span></code></pre></div>
<p><code>respR</code> does not currently have a specialised function for determining background respiration in flowthrough data. However the main <code>calc_rate.ft</code> function can be used to examine data from ‘blank’ experiments for background rates, and these (or an average of several) can be entered as above. The user should however be aware that only background rates determined at the <em>same flow rate</em> should be used.</p>
</div>
<div id="converting-rates" class="section level2">
<h2 class="hasAnchor">
<a href="#converting-rates" class="anchor"></a>Converting rates</h2>
<p>The <code><a href="../reference/convert_rate.html">convert_rate()</a></code> function is used to convert rates to particular units. As with converting rates from closed and intermittent-flow respirometry (i.e. outputs of <code><a href="../reference/calc_rate.html">calc_rate()</a></code>), conversion of flowthrough rates (i.e. from <code><a href="../reference/calc_rate.ft.html">calc_rate.ft()</a></code>) requires the <code>o2.unit</code> of the original data, as well as a <code>time.unit</code> and <code>volume</code> value. With flowthrough data, these relate to the <code>flowrate</code> units. As we said earlier, the flow rate should be in L per unit time, therefore the <code>volume</code> should be entered as 1, and <code>time.unit</code> as the time unit of the flow rate. For example, if the flow rate was in L min<sup>-1</sup>, these should be <code>time.unit = "m", volume = 1</code>. Note, in flowthrough respirometry as long as equilibrium has been reached the volume of the respirometer is <em>not important</em>, it is the flow rate through it that is important in determining uptake rate.</p>
<p>The function returns a rate for the specimen, and if a <code>mass</code> is entered (in kg) it returns a mass-specific rate. We specify our desired units of the final rates using <code>output.unit</code>:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="co"># conversion of mean rate</span></span>
<span id="cb15-2"><a href="#cb15-2"></a><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(chiton.ft.rate.sub<span class="op">$</span>mean, <span class="dt">o2.unit =</span> <span class="st">"mg/l"</span>, <span class="dt">time.unit =</span> <span class="st">"m"</span>, <span class="dt">output.unit =</span> <span class="st">"mg/h"</span>, </span>
<span id="cb15-3"><a href="#cb15-3"></a>    <span class="dt">volume =</span> <span class="dv">1</span>)</span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">#&gt; </span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">#&gt; # convert_rate # ------------------------</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">#&gt; Rank/position 1 result shown. To see all results use summary().</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">#&gt; Input:</span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">#&gt; [1] -0.001651307</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">#&gt; [1] "mg/L" "min" </span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">#&gt; Converted:</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">#&gt; [1] -0.09907844</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">#&gt; [1] "mg/hour"</span></span>
<span id="cb15-13"><a href="#cb15-13"></a></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="kw"><a href="../reference/convert_rate.html">convert_rate</a></span>(chiton.ft.rate.sub<span class="op">$</span>mean, <span class="dt">o2.unit =</span> <span class="st">"mg/l"</span>, <span class="dt">time.unit =</span> <span class="st">"m"</span>, <span class="dt">output.unit =</span> <span class="st">"mg/h/g"</span>, </span>
<span id="cb15-15"><a href="#cb15-15"></a>    <span class="dt">volume =</span> <span class="dv">1</span>, <span class="dt">mass =</span> <span class="fl">7e-05</span>)</span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">#&gt; </span></span>
<span id="cb15-17"><a href="#cb15-17"></a><span class="co">#&gt; # convert_rate # ------------------------</span></span>
<span id="cb15-18"><a href="#cb15-18"></a><span class="co">#&gt; Rank/position 1 result shown. To see all results use summary().</span></span>
<span id="cb15-19"><a href="#cb15-19"></a><span class="co">#&gt; Input:</span></span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">#&gt; [1] -0.001651307</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">#&gt; [1] "mg/L" "min" </span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">#&gt; Converted:</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">#&gt; [1] -1.415406</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">#&gt; [1] "mg/hour/g"</span></span></code></pre></div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#inspecting-data">Inspecting data</a></li>
      <li><a href="#subsetting-data">Subsetting data</a></li>
      <li><a href="#adjusting-rates">Adjusting rates</a></li>
      <li><a href="#converting-rates">Converting rates</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Januar Harianto, Nicholas Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
